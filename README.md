# rs-log-analyser

高速なログ解析ツール - Rustで実装されたパターンマッチングベースのログアナライザー

## 概要

`rs-log-analyser`は、大量のログファイルから特定のパターンにマッチするテキストを抽出し、その出現回数をカウントするコマンドラインツールです。正規表現を使用してログの解析を行い、結果をタブ区切り形式で出力します。

## 特徴

🚀 **高速処理** - Rustの並行処理とメモリ効率性により、大容量ログファイルを高速に処理  
🎯 **正規表現サポート** - 柔軟なパターンマッチングで複雑な検索条件に対応  
📊 **集計機能** - マッチしたパターンの出現回数を自動カウント  
💾 **メモリ効率** - ストリーミング処理でメモリ使用量を最小限に抑制  
🔧 **シンプルなCLI** - 直感的なコマンドラインインターフェース  
⚡ **最適化済み** - リリースビルドでサイズと速度を最適化

## 使用方法

### 基本的な使用法

```bash
rs-log-analyser --input <ログファイルパス> --pattern '<正規表現パターン>'
```

### オプション

- `-i, --input <FILE>`: 解析対象のログファイルを指定
- `-p, --pattern <PATTERN>`: マッチング用の正規表現パターンを指定

### 使用例

#### アクセスログから特定日時のエントリを抽出

```bash
rs-log-analyser --input access_log --pattern '22/Feb/2025:\d\d'
```

#### IPアドレスのアクセス頻度を調査

```bash
rs-log-analyser --input access_log --pattern '\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'
```

#### HTTPステータスコードの集計

```bash
rs-log-analyser --input access_log --pattern 'HTTP/1\.[01]" \d{3}'
```

## 出力形式

結果はタブ区切り形式で出力されます：

```text
<マッチしたテキスト>\t<出現回数>
```

### 出力例

```text
22/Feb/2025:14	10167
22/Feb/2025:06	2769
22/Feb/2025:07	5617
22/Feb/2025:19	11452
22/Feb/2025:23	10891
22/Feb/2025:13	8597
22/Feb/2025:05	1969
22/Feb/2025:12	8993
22/Feb/2025:21	11195
22/Feb/2025:09	8042
22/Feb/2025:16	9562
22/Feb/2025:04	346
22/Feb/2025:10	7730
22/Feb/2025:11	9216
22/Feb/2025:22	11182
22/Feb/2025:08	8643
22/Feb/2025:18	11245
22/Feb/2025:20	12195
22/Feb/2025:15	9588
22/Feb/2025:17	7674
```

## 技術仕様

- **言語**: Rust 2024 Edition
- **主要依存関係**:
    - `clap` 4.5.31: コマンドライン引数の解析
    - `regex` 1.11.1: 正規表現エンジン
- **最適化**: リリースビルドでサイズと速度を最適化

## パフォーマンス最適化

このツールは以下の最適化が施されています：

- **LTO (Link Time Optimization)**: リンク時最適化により実行速度を向上
- **シンボル削除**: 実行ファイルサイズを削減
- **パニック時即座終了**: エラー処理のオーバーヘッドを削減
- **単一コード生成ユニット**: 最大限の最適化を実現

## トラブルシューティング

### よくある問題

**Q: 正規表現のコンパイルエラーが発生する**  
A: パターンの構文を確認してください。複雑な正規表現の場合は、エスケープが必要な文字があるかチェックしてください。

**Q: ファイルが見つからないエラー**  
A: 入力ファイルのパスが正しいか、ファイルの読み取り権限があるかを確認してください。

**Q: メモリ不足エラー**  
A: 非常に大きなファイルの場合、システムのメモリ容量を確認してください。